<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Plataforma de Simulados</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen p-6">
  <div class="max-w-5xl mx-auto">
    <h1 class="text-3xl font-bold mb-6 text-center">Plataforma de Simulados</h1>

    <!-- Seleção do simulado -->
    <div class="flex gap-2 justify-center mb-6">
      <select id="simuladoSelect" class="border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
        <option value="">Selecione o Simulado</option>
        <option value="simulado1">Simulado 01</option>
        <option value="simulado2">Simulado 02</option>
      </select>
      <input id="matriculaInput" type="text" placeholder="Digite sua matrícula"
             class="border rounded-lg px-4 py-2 w-1/3 focus:outline-none focus:ring-2 focus:ring-blue-500">
      <button onclick="buscarAluno()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">Buscar</button>
    </div>

    <!-- Resultado -->
    <div id="resultado" class="hidden">
      <div class="bg-gray-800 p-4 rounded-xl shadow mb-6">
        <h2 id="tituloSimulado" class="text-2xl font-semibold mb-4"></h2>
        <p id="nome" class="text-lg font-semibold mb-2"></p>
        <div id="areas" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
      </div>
      <button onclick="voltar()" class="px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-700">Voltar</button>
    </div>

    <p id="erro" class="text-red-500 text-center hidden mt-4">❌ Matrícula não encontrada ou simulado não selecionado</p>
  </div>

  <script>
    let dadosAlunos = {};

    async function buscarAluno() {
      const simulado = document.getElementById("simuladoSelect").value;
      const matricula = document.getElementById("matriculaInput").value.trim();
      const resultadoDiv = document.getElementById("resultado");
      const erro = document.getElementById("erro");

      if (!simulado || matricula === "") {
        resultadoDiv.classList.add("hidden");
        erro.classList.remove("hidden");
        return;
      }

      try {
        // Carregar JSON do simulado
        dadosAlunos = await fetch(`dados/${simulado}_alunos.json`).then(r => r.json());

        // Encontrar o aluno (converter matrícula para número)
        const aluno = dadosAlunos.find(a => a.matricula == matricula);
        if (!aluno) {
          resultadoDiv.classList.add("hidden");
          erro.classList.remove("hidden");
          return;
        }

        erro.classList.add("hidden");
        resultadoDiv.classList.remove("hidden");

        document.getElementById("tituloSimulado").textContent = `Simulado: ${simulado}`;
        document.getElementById("nome").textContent = `Aluno: ${aluno.aluno}`;

        // Mostrar áreas
        const areasDiv = document.getElementById("areas");
        areasDiv.innerHTML = '';
        const labels = ["LC", "CH", "CN", "MT"];

        labels.forEach(area => {
          const notaAluno = aluno[area];

          const card = document.createElement("div");
          card.className = "bg-gray-700 p-4 rounded-xl";
          card.innerHTML = `
            <h3 class="text-lg font-bold">${area}</h3>
            <p><strong>Nota do aluno:</strong> ${notaAluno}</p>
          `;
          areasDiv.appendChild(card);
        });

      } catch (err) {
        console.error(err);
        resultadoDiv.classList.add("hidden");
        erro.classList.remove("hidden");
      }
    }

    function voltar() {
      document.getElementById("resultado").classList.add("hidden");
      document.getElementById("erro").classList.add("hidden");
    }
  </script>
</body>
</html>
